@using Microsoft.AspNetCore.Identity
@using MelodyCircle.Data
@inject UserManager<User> UserManager
@inject ApplicationDbContext Context

@{
    ViewData["Title"] = "Admin Panel";
}

<table class="table">
	<thead>
	<tr>
		<th>Username</th>
		<th>Email</th>
		<th>Role</th>
		<th>Actions</th>
	</tr>
	</thead>
	<tbody>
	@foreach (var user in Model)
	{
		<tr>
			<td>@user.UserName</td>
			<td>@user.Email</td>
			<td>
				@{
					var userRoles = await UserManager.GetRolesAsync(user);
					var rolesString = string.Join(", ", userRoles);
				}
				@rolesString
			</td>
			<td>
				<a asp-action="EditUser" asp-area="" asp-controller="Admin" asp-route-id="@user.UserName">Edit</a> |
				<a asp-action="DeleteUser" asp-area="" asp-controller="Admin" asp-route-id="@user.UserName">Delete</a>
			</td>
		</tr>
	}
	</tbody>
</table>

<div>
	<form method="post" asp-action="CreateMultipleUsers">
		<div class="form-group">
			<label for="numberOfUsers">Número de Utilizadores:</label>
			<input type="number" class="form-control" id="numberOfUsers" name="numberOfUsers" value="100">
		</div>
		<button type="submit" class="btn bg-purple text-white">Criar Users</button>
	</form>
	<p></p>
	<form asp-action="DeleteAddedUsers" method="post" asp-controller="Admin">
		<button type="submit" class="btn bg-purple text-white">Excluir Users Criados</button>
	</form>
</div>

<div class="sidebar">
	<h2>Informações da Aplicação</h2>
	<ul>
		<li><strong>Versão:</strong> 1.0.0</li>
		<li><strong>Última Atualização:</strong> 27 de Março de 2024</li>
		<li><strong>Utilizadores</strong> @Context.Users.Count()</li>
		<li><strong>Tutoriais:</strong> @Context.Tutorials.Count()</li>
		<li><strong>Steps:</strong> @Context.Steps.Count()</li>
		<li><strong>Collabs:</strong> @Context.Collaborations.Count()</li>
	</ul>
</div>
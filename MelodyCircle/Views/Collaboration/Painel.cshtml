@using Microsoft.AspNetCore.Identity
@inject UserManager<User> UserManager

@model ArrangementPanelViewModel

@{
    ViewBag.Title = "Painel de Arranjo";
    var user = await UserManager.GetUserAsync(User);
    var userId = user?.Id;
    var assignedTrack = Model.Tracks.FirstOrDefault(t => t.AssignedUserId.ToString() == userId);
    var assignedTrackNumber = assignedTrack != null ? Model.Tracks.IndexOf(assignedTrack) + 1 : 0;
    var userHasTrack = assignedTrackNumber > 0;
}

<div class="container-fluid">
    <div class="row">
        <div class="col-md-2">
            <!-- Menu Lateral de Instrumentos -->
            <div id="instrument-menu">
                <h3>INSTRUMENTOS</h3>
                <!-- Os instrumentos serão carregados aqui -->
                <!-- Exemplo Estático -->
                <div class="instrument" draggable="true">Guitar</div>
                <div class="instrument" draggable="true">Bass</div>
                <div class="instrument" draggable="true">Drums</div>
                <!-- Botão de Upload de Instrumento -->
                <button id="upload-button">UPLOAD</button>
            </div>
        </div>
        <div class="col-md-10">
            <!-- Painel de Arranjo -->
            <div id="arrangement-panel">
                <div class="header">
                    <span>BPM: <input type="number" id="bpm" value="102" min="60" max="150" /></span>
                    <span class="time-limit">4:00</span>
                    @if (userHasTrack)
                    {
                        <span>A tua faixa: @assignedTrackNumber</span>
                    }
                    else
                    {
                        <span>Não tens faixa atribuída</span>
                    }
                </div>
                <!-- As faixas serão carregadas aqui -->
                @foreach (var track in Model.Tracks)
                {
                    <div class="track" data-track-id="@track.Id">
                        @if (track.AssignedUserId.ToString() == userId)
                        {
                            <span>Esta é a tua faixa</span>
                            <!-- O conteúdo da faixa do usuário vai aqui -->
                        }
                        else
                        {
                            <span>Faixa @Model.Tracks.IndexOf(track) + 1</span>
                            <!-- O conteúdo de outras faixas vai aqui -->
                        }
                    </div>
                }
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>
        // Implemente o JavaScript necessário para manipulação do drag-and-drop, etc.
        // Lembre-se de incluir a lógica para garantir que os usuários só podem arrastar instrumentos para suas próprias faixas.
    </script>
}

<style>
   @* Adicione estilos conforme necessário aqui *@
</style>